<!-- CHANGELOG/20251031172608.md -->
# 2025-10-31 17:26:08 UTC — wa-zip com autoria e composição Docker cloud

## Arquivos atualizados
- `cloud/api/src/modules/whatsapp/whatsapp.service.ts`, `whatsapp.controller.ts`, `dto/wa-zip-response.dto.ts`, `whatsapp.service.spec.ts` — enrichimento do fluxo `/wa-zip` com associação de autores via `_chat.txt`, geração de TXT, JSON `{origem, author, extected}` e ajuste dos testes.
- `cloud/api/README.md` — documentação do endpoint atualizada com novos campos retornados e instruções sobre os artefatos gerados.
- `cloud/api/Dockerfile`, `cloud/ui/Dockerfile` — adoção de entrypoints dedicados e preparação para uso no `docker-compose` raiz.
- `proj/01-arquitetura/integracoes-com-apis-spec.md`, `proj/02-design/componentes-spec.md`, `proj/03-implementacao/estrutura-de-projeto-spec.md` — RUP alinhada ao tratamento de autores, JSON/TXT e novo compose raiz.

## Novos arquivos
- `cloud/api/entrypoint.sh`, `cloud/ui/entrypoint.sh` — entrypoints compatíveis com a política de automação, preparando diretórios e delegando ao comando original.
- `docker-compose.yml` — orquestração raiz dos serviços `cloud-api` e `cloud-ui`, propagando variáveis `${VAR:-default}` e montando `extracted/` para inspeção.

## Regras e requisitos atendidos
- Implementa a solicitação do usuário para que o `/wa-zip` identifique autores a partir do `_chat.txt`, gere `.txt` individuais e inclua `author` nas respostas enviadas ao OpenRouter, mantendo o processamento unitário dos arquivos.
- Mantém conformidade com `AGENTS.md`: cabeçalhos de caminho corrigidos, sem scripts adicionais fora dos entrypoints permitidos, valores literais extraídos para constantes e documentação confinada a `proj/`.
- Cadeia `.env → docker-compose → código` preservada ao introduzir o compose raiz e garantir que `OPENROUTER_*` continuem parametrizáveis; `entrypoint.sh` cria `extracted/` antes da execução para cumprir convenções de armazenamento.
- Teste automatizado executado: `npm test -- whatsapp` (cloud/api) validando extração, autoria e gravação de JSON/TXT.

## Pendências e próximos passos
- Replicar o volume `extracted/` em ambientes não-produtivos com políticas de retenção e descarte documentadas em `proj/05-entrega-e-implantacao/`.
- Revisar limites de upload e cenários com múltiplos anexos de mesmo nome, garantindo políticas de deduplicação e auditoria descritas nas próximas iterações.
- Atualizar variáveis reais em `.env` corporativo antes de subir o compose em ambiente monitorado, mantendo o registro de rotação segundo `proj/06-governanca-tecnica-e-controle-de-qualidade/`.
