<!-- req/02-planejamento/riscos-e-mitigacoes.md -->
# Riscos e Mitiga√ß√µes

> Base: [./riscos-e-mitigacoes.md](./riscos-e-mitigacoes.md)
> Plano: [/docs/plans/20251025093000-evolucao-req-spec.md](/docs/plans/20251025093000-evolucao-req-spec.md)
> Changelog: [/CHANGELOG.md#2025-10-25](/CHANGELOG.md#2025-10-25)
> Refer√™ncias correlatas: [Arquitetura da extens√£o](/req/01-arquitetura/arquitetura-da-extensao-spec.md) ¬∑ [Design geral](/req/02-design/design-geral-spec.md) ¬∑ [Testes end-to-end](/req/04-testes-e-validacao/testes-end-to-end-spec.md)

Este cap√≠tulo consolida a gest√£o de riscos do programa RUP da extens√£o Chrome MBRA. Ele unifica a matriz geral de riscos anteriormente mantida em `RISKS.md` com os riscos espec√≠ficos do plano de requisitos UI/UX vers√£o 5, garantindo rastreabilidade √∫nica.

- **Matriz geral (IDs `RISK-###`):** migrada do documento `RISKS.md`, preservando categorias, impactos e refer√™ncias cruzadas com requisitos, pipelines e relat√≥rios.
- **Riscos espec√≠ficos de UI/UX (IDs `R1`‚Äì`R8`):** mantidos do plano de requisitos UI/UX v5 para monitorar diverg√™ncias de design e opera√ß√£o.

---

## Atualiza√ß√µes quando requisitos afetarem riscos

- Para cada novo `REQ-###` ou `RNF-###`, avalie se h√° riscos in√©ditos ou ajustes em severidade e registre-os tanto aqui quanto em `riscos-e-mitigacoes.md`.
- Referencie sempre o requisito associado, atualize o plano de mitiga√ß√£o correspondente e sincronize impactos com `cronograma.md`, `especificacao-de-requisitos.md` e `audit-history.md`.
- Registre o item no `CHANGELOG.md`, informe o status da revis√£o em `../06-governanca-tecnica-e-controle-de-qualidade/auditoria-e-rastreabilidade.md` e garanta que relat√≥rios automatizados reflitam a altera√ß√£o.

---

As se√ß√µes a seguir apresentam primeiro a matriz geral e, na sequ√™ncia, a vis√£o dedicada a UI/UX, mantendo expl√≠cita a origem de cada conjunto de riscos.

## Riscos Gerais (RUP)

A matriz abaixo reflete a consolida√ß√£o realizada pelo comit√™ de governan√ßa t√©cnica e IA. Cada item mant√©m rastreabilidade direta com requisitos, pipelines e agentes para facilitar auditoria.

### Estrutura de classifica√ß√£o

| Categoria | Descri√ß√£o |
| --- | --- |
| T√©cnico | Riscos relacionados a arquitetura, c√≥digo, tecnologia e compatibilidade. |
| Operacional | Falhas humanas, processos ou infraestrutura. |
| Legal / Conformidade | Viola√ß√£o de LGPD, pol√≠ticas do Chrome ou obriga√ß√µes contratuais. |
| Externo / Depend√™ncia | Depend√™ncia de servi√ßos externos (APIs, OpenRouter, Codex, Google). |

### Riscos T√©cnicos

| ID | Descri√ß√£o | Impacto | Prob. | Mitiga√ß√£o | Rastreio | Status |
| --- | --- | --- | --- | --- | --- | --- |
| RISK-001 | Falha de autentica√ß√£o SSO Google em ambientes restritos (rede corporativa). | üüß M√©dio | M√©dia | Implementar fallback de autentica√ß√£o com mensagem orientativa. | [REQ-001](requisitos-spec.md#req-001), [`../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia.md`](../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia-spec.md) | Ativo |
| RISK-002 | Quebra de compatibilidade com futuras vers√µes do Chrome Manifest V3. | üü• Alto | Alta | Revisar Manifest a cada release e validar via `audit.yml`. | [REQ-018](requisitos-spec.md#req-018), [`../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia.md`](../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia-spec.md) | Ativo |
| RISK-003 | Corrup√ß√£o de dados no IndexedDB por fechamento abrupto do navegador. | üü® Baixo | M√©dia | Sincronizar transa√ß√µes e utilizar IndexedDB Promises. | [REQ-011](requisitos-spec.md#req-011), [`../03-implementacao/testes.md`](../03-implementacao/testes-spec.md) | Ativo |
| RISK-004 | Falha de intercepta√ß√£o de downloads devido a pol√≠ticas CORS. | üü• Alto | M√©dia | Validar permiss√µes `downloads` e `host_permissions`. | [REQ-020](requisitos-spec.md#req-020) | Ativo |
| RISK-005 | Depend√™ncia excessiva de modelos externos (OpenRouter). | üüß M√©dio | Alta | Garantir fallback local via LM Studio / Ollama. | [`../../AGENTS.md`](../../AGENTS.md) | Ativo |

### Riscos Operacionais

| ID | Descri√ß√£o | Impacto | Prob. | Mitiga√ß√£o | Rastreio | Status |
| --- | --- | --- | --- | --- | --- | --- |
| RISK-006 | Falha na configura√ß√£o de secrets (tokens) nos pipelines. | üü• Alto | M√©dia | Implementar verifica√ß√£o autom√°tica no `audit.yml`. | [`../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia.md`](../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia-spec.md) | Ativo |
| RISK-007 | Erros humanos em merges ou PRs autom√°ticos. | üüß M√©dio | Alta | Requerer revis√£o humana obrigat√≥ria antes do merge. | [`../../AGENTS.md`](../../AGENTS.md) | Ativo |
| RISK-008 | Falha em builds automatizados (ambiente CI inst√°vel). | üü® Baixo | M√©dia | Cache de depend√™ncias e retries autom√°ticos. | [`../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia.md`](../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia-spec.md) | Ativo |
| RISK-009 | Execu√ß√£o incorreta de agentes IA fora do contexto correto. | üüß M√©dio | M√©dia | Validar `workflow_dispatch` antes da execu√ß√£o. | [`../../AGENTS.md`](../../AGENTS.md) | Ativo |
| RISK-010 | Ac√∫mulo de relat√≥rios grandes e logs desnecess√°rios. | üü® Baixo | Alta | Implementar limpeza autom√°tica de artefatos antigos. | [`../06-governanca-tecnica-e-controle-de-qualidade/auditoria-e-rastreabilidade.md#catalogo-de-relatorios-automatizados`](../06-governanca-tecnica-e-controle-de-qualidade/auditoria-e-rastreabilidade-spec.md#catalogo-de-relatorios-automatizados) | Ativo |

### Riscos Legais e de Conformidade

| ID | Descri√ß√£o | Impacto | Prob. | Mitiga√ß√£o | Rastreio | Status |
| --- | --- | --- | --- | --- | --- | --- |
| RISK-011 | Falta de exibi√ß√£o do termo de consentimento LGPD antes da coleta de dados. | üü• Alto | M√©dia | Validar exibi√ß√£o via testes E2E e auditoria mensal. | [REQ-024](requisitos-spec.md#req-024), [REQ-025](requisitos-spec.md#req-025) | Ativo |
| RISK-012 | Armazenamento indevido de informa√ß√µes pessoais fora do IndexedDB. | üü• Alto | Baixa | Proibir `localStorage` e validar via lint de seguran√ßa. | [REQ-027](requisitos-spec.md#req-027) | Ativo |
| RISK-013 | Falha no direito de exclus√£o de dados (revoga√ß√£o LGPD). | üüß M√©dio | M√©dia | Incluir fun√ß√£o "Excluir Dados" obrigat√≥ria no painel. | [REQ-027](requisitos-spec.md#req-027) | Ativo |
| RISK-014 | Viola√ß√£o das pol√≠ticas do Chrome Web Store (execu√ß√£o remota). | üü• Alto | Baixa | Auditar CSP e Manifest antes de cada release. | [REQ-030](requisitos-spec.md#req-030) | Ativo |
| RISK-015 | Uso indevido de tokens JWT expostos em logs. | üü• Alto | M√©dia | Redigir m√°scaras autom√°ticas nos logs CI/CD. | [`../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia.md`](../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia-spec.md) | Ativo |

### Riscos Externos e de Depend√™ncia

| ID | Descri√ß√£o | Impacto | Prob. | Mitiga√ß√£o | Rastreio | Status |
| --- | --- | --- | --- | --- | --- | --- |
| RISK-016 | Indisponibilidade da API yagnostic.mbra.com.br. | üü• Alto | M√©dia | Implementar retries e fallback de status offline. | [REQ-003](requisitos-spec.md#req-003), [REQ-005](requisitos-spec.md#req-005) | Ativo |
| RISK-017 | Altera√ß√µes n√£o anunciadas na API MBRA (vers√£o RESTful). | üüß M√©dio | M√©dia | Utilizar versionamento de endpoint (`/v1`, `/v2`). | [REQ-003](requisitos-spec.md#req-003), [REQ-005](requisitos-spec.md#req-005) | Ativo |
| RISK-018 | Incompatibilidade com OpenRouter ou Codex devido a mudan√ßas de modelo. | üüß M√©dio | Alta | Registrar vers√µes de modelo em [`../../AGENTS.md`](../../AGENTS.md). | Ativo |
| RISK-019 | Falhas de autentica√ß√£o com Google OAuth. | üü• Alto | Baixa | Exibir erro informativo e reautentica√ß√£o autom√°tica. | [REQ-001](requisitos-spec.md#req-001) | Ativo |
| RISK-020 | Bloqueio tempor√°rio de execu√ß√£o IA por uso excessivo. | üü® Baixo | M√©dia | Aplicar rate limit inteligente nos pipelines. | [`../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia.md`](../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia-spec.md) | Ativo |

### Mapa de severidade

| Severidade | S√≠mbolo | A√ß√£o imediata |
| --- | --- | --- |
| Alta | üü• | Mitiga√ß√£o obrigat√≥ria e auditoria semanal |
| M√©dia | üüß | Acompanhamento quinzenal |
| Baixa | üü® | Verifica√ß√£o mensal |

### Monitoramento e revis√£o

- Todos os riscos s√£o auditados mensalmente pelo Audit Agent via pipeline `audit.yml`.
- Novos riscos s√≥ podem ser adicionados via Pull Request revisado por IA + humano.
- Cada `RISK-###` deve ter rastreabilidade em:
- [`requisitos.md`](requisitos-spec.md) (cat√°logo tabular).
  - [`../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia.md`](../06-governanca-tecnica-e-controle-de-qualidade/revisoes-com-ia-spec.md) (monitoramento).
  - [`../06-governanca-tecnica-e-controle-de-qualidade/auditoria-e-rastreabilidade.md#catalogo-de-relatorios-automatizados`](../06-governanca-tecnica-e-controle-de-qualidade/auditoria-e-rastreabilidade-spec.md#catalogo-de-relatorios-automatizados) (verifica√ß√£o).
- Riscos obsoletos s√£o marcados como `[MITIGADO]` e arquivados em `/docs/risk-archive/`.

### Responsabilidade t√©cnica

**Respons√°vel:** Ricardo Malnati ‚Äî Engenheiro de Software  \
**Organiza√ß√£o:** Millennium Brasil (MBRA)  \
**Documento:** Matriz de Riscos e Mitiga√ß√µes RUP  \
**Status:** Ativo e sob auditoria cont√≠nua



## Riscos Espec√≠ficos de UI/UX (Plano UI/UX v5)

Esta se√ß√£o preserva o monitoramento dedicado aos riscos de experi√™ncia do usu√°rio aprovados no plano de requisitos UI/UX vers√£o 5, mantendo-os separados da matriz geral para facilitar o acompanhamento pelo time de design. „ÄêF:docs/plans/plan-ui-ux-requirements-v5.md‚Ä†L112-L150„Äë

| ID | Risco | Probabilidade | Impacto | Mitiga√ß√£o | Refer√™ncias |
| --- | --- | --- | --- | --- | --- |
| R1 | Diverg√™ncia visual entre prot√≥tipo e React (cores, espa√ßamento, tokens) | M√©dia | Alto | Medi√ß√£o obrigat√≥ria da regra 60-30-10 e revis√£o cruzada com UX antes de merge. |„ÄêF:prototype/dashboard-visao-geral.html‚Ä†L1-L220„Äë„ÄêF:req/06-governanca-tecnica-e-controle-de-qualidade/controle-de-qualidade.md‚Ä†L53-L78„Äë|
| R2 | Prompts m√©dicos inconsistentes entre API e documenta√ß√£o | Baixa | Alto | Consolidar prompts em `diagnostics.service.ts` e atualizar req quando modificados. |„ÄêF:api/src/diagnostics/diagnostics.service.ts‚Ä†L21-L199„Äë„ÄêF:CHANGELOG/20260308120000.md‚Ä†L1-L16„Äë|
| R3 | Performance degradada em uploads grandes (>8‚ÄØMB) ou gera√ß√£o de √°udio simult√¢nea | M√©dia | M√©dio | Monitorar dura√ß√£o de `/diagnostics/submit`, aplicar fila local (`wl-db`) e alertar quando exceder 30‚ÄØs. |„ÄêF:ui/src/UploadHelper.ts‚Ä†L63-L154„Äë„ÄêF:api/src/diagnostics/diagnostics.controller.ts‚Ä†L69-L189„Äë|
| R4 | Aprova√ß√£o administrativa atrasada bloqueando opera√ß√£o | Alta | Alto | Implementar notifica√ß√µes proativas e relat√≥rios de pend√™ncia; disponibilizar contatos no prot√≥tipo. |„ÄêF:prototype/administracao-liberacao.html‚Ä†L1-L120„Äë„ÄêF:prototype/faq-aprovacao.html‚Ä†L1-L120„Äë|
| R5 | Consentimento expirado sem bloqueio autom√°tico | M√©dia | Alto | Persistir vers√£o/timestamp do consentimento e validar em cada login antes de liberar upload. |„ÄêF:ui/src/components/onboarding/OnboardingFlow.tsx‚Ä†L1-L200„Äë„ÄêF:prototype/consentimento-completo.html‚Ä†L1-L92„Äë|
| R6 | Depend√™ncia de ElevenLabs para √°udio gera custo inesperado | M√©dia | M√©dio | Habilitar √°udio apenas sob confirma√ß√£o expl√≠cita e registrar consumo em relat√≥rios operacionais. |„ÄêF:prototype/diagnostico-operacao.html‚Ä†L68-L120„Äë„ÄêF:api/src/diagnostics/diagnostics.controller.ts‚Ä†L121-L189„Äë|
| R7 | Falta de rastreabilidade em compartilhamentos (WhatsApp/E-mail) | M√©dia | Alto | Registrar logs com operador, canal e timestamp; armazenar evid√™ncias em `docs/reports/`. |„ÄêF:prototype/dashboard-visao-geral.html‚Ä†L140-L200„Äë„ÄêF:req/06-governanca-tecnica-e-controle-de-qualidade/auditoria-e-rastreabilidade.md‚Ä†L31-L104„Äë|
| R8 | Fallback local sem sincroniza√ß√£o autom√°tica gera dados obsoletos | Baixa | M√©dio | Implementar rotina de retry manual assistido com instru√ß√µes claras e monitoramento di√°rio. |„ÄêF:ui/src/UploadHelper.ts‚Ä†L63-L154„Äë„ÄêF:ui/src/components/dashboard/DiagnosticQueue.tsx‚Ä†L150-L210„Äë|

### Normas de Mitiga√ß√£o para Evolu√ß√µes de UI
- **React oficial:** riscos que proponham bibliotecas alternativas devem registrar plano de retorno ao React oficial antes da execu√ß√£o da mitiga√ß√£o. „ÄêF:req/02-design/componentes.md‚Ä†L120-L150„Äë
- **Feature-Sliced Design:** mitiga√ß√£o de riscos estruturais deve incluir revis√£o das fatias afetadas e atualiza√ß√£o dos diret√≥rios `components/<feature>`, mantendo rastreabilidade com o RUP. „ÄêF:req/02-design/fluxos.md‚Ä†L96-L115„Äë
- **Atomic Design:** qualquer corre√ß√£o envolvendo componentes precisa especificar quais √°tomos/mol√©culas ser√£o tocados para evitar regress√µes n√£o rastreadas. „ÄêF:req/02-design/componentes.md‚Ä†L138-L150„Äë

## Monitoramento Cont√≠nuo
- Revisar riscos trimestralmente em conjunto com governan√ßa t√©cnica e compliance.
- Registrar decis√µes mitigat√≥rias no changelog e nos relat√≥rios de auditoria (`docs/reports/`). „ÄêF:req/06-governanca-tecnica-e-controle-de-qualidade/auditoria-e-rastreabilidade.md‚Ä†L31-L104„Äë
- Atualizar esta tabela quando novos fluxos forem introduzidos ou quando a API real substituir os mocks atuais.

[Voltar ao √≠ndice](README-spec.md)
