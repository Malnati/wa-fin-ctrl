<!-- templates/print_report.html.j2 -->
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <style>
    @page { size: A4 portrait; margin: 2cm; }
    body { font-family: Arial, sans-serif; font-size: 12px; margin: 0; padding: 0; }
    h1 { text-align: center; margin-bottom: 20px; font-size: 18px; }
    .header-info { margin-bottom: 20px; }
    .header-info span { display: inline-block; width: 45%; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
    th, td { border: 1px solid #000; padding: 4px; text-align: left; }
    th { background-color: #f0f0f0; }
    .signature { margin-top: 40px; }
    .signature div { display: inline-block; width: 45%; text-align: center; }
    #download-edits { margin: 20px 0; padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    #download-edits:hover { background-color: #0056b3; }
  </style>
</head>
<body>
  <h1>Prestação de Contas - {{ periodo }}</h1>
  <div class="header-info">
    <span>Curador: ____________________________</span>
    <span>Curatelado: __________________________</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Data</th>
        <th>Descrição</th>
        <th>Receitas (R$)</th>
        <th>Despesas (R$)</th>
        <th>Saldo (R$)</th>
      </tr>
    </thead>
    <tbody>
      {% for row in rows %}
      <tr data-id="{{ row.identificador_unico }}">
        <td>{{ row.data }}</td>
        <td data-field="descricao">{{ row.descricao }}</td>
        <td data-field="receitas">{{ row.receitas }}</td>
        <td data-field="despesas">{{ row.despesas }}</td>
        <td data-field="saldo">{{ row.saldo }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <button id="download-edits">Salvar</button>
  <div class="signature">
    <div>Local, ___/___/_____<br>Assinatura do Curador</div>
    <div>Data, ___/___/_____<br>Assinatura do Curatelado</div>
  </div>
  <script>
    // JavaScript para edição inline (mantido do código original)
    document.addEventListener('DOMContentLoaded', function() {
      // Tornar células editáveis
      document.querySelectorAll('td[data-field]').forEach(cell => {
        cell.contentEditable = true;
        cell.addEventListener('blur', function() {
          // Salvar alterações quando perder foco
          console.log('Campo editado:', this.getAttribute('data-field'), this.textContent);
        });
      });
      
      // Botão de download
      document.getElementById('download-edits').addEventListener('click', function() {
        const data = [];
        document.querySelectorAll('tbody tr').forEach(row => {
          const rowData = {
            id: row.getAttribute('data-id'),
            descricao: row.querySelector('[data-field="descricao"]').textContent,
            receitas: row.querySelector('[data-field="receitas"]').textContent,
            despesas: row.querySelector('[data-field="despesas"]').textContent,
            saldo: row.querySelector('[data-field="saldo"]').textContent
          };
          data.push(rowData);
        });
        
        const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'relatorio_editado.json';
        a.click();
        URL.revokeObjectURL(url);
      });
    });
  </script>
</body>
</html> 